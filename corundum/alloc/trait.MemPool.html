<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="API documentation for the Rust `MemPool` trait in crate `corundum`."><meta name="keywords" content="rust, rustlang, rust-lang, MemPool"><title>corundum::alloc::MemPool - Rust</title><link rel="stylesheet" type="text/css" href="../../normalize.css"><link rel="stylesheet" type="text/css" href="../../rustdoc.css" id="mainThemeStyle"><link rel="stylesheet" type="text/css" href="../../light.css"  id="themeStyle"><link rel="stylesheet" type="text/css" href="../../dark.css" disabled ><link rel="stylesheet" type="text/css" href="../../ayu.css" disabled ><script id="default-settings"></script><script src="../../storage.js"></script><noscript><link rel="stylesheet" href="../../noscript.css"></noscript><link rel="icon" type="image/svg+xml" href="../../favicon.svg">
<link rel="alternate icon" type="image/png" href="../../favicon-16x16.png">
<link rel="alternate icon" type="image/png" href="../../favicon-32x32.png"><style type="text/css">#crate-search{background-image:url("../../down-arrow.svg");}</style></head><body class="rustdoc trait"><!--[if lte IE 8]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="sidebar"><div class="sidebar-menu">&#9776;</div><a href='../../corundum/index.html'><div class='logo-container rust-logo'><img src='../../rust-logo.png' alt='logo'></div></a><p class="location">Trait MemPool</p><div class="sidebar-elems"><div class="block items"><a class="sidebar-title" href="#required-methods">Required Methods</a><div class="sidebar-links"><a href="#tymethod.pre_alloc">pre_alloc</a><a href="#tymethod.pre_dealloc">pre_dealloc</a></div><a class="sidebar-title" href="#provided-methods">Provided Methods</a><div class="sidebar-links"><a href="#method.alloc">alloc</a><a href="#method.alloc_for_value">alloc_for_value</a><a href="#method.alloc_zeroed">alloc_zeroed</a><a href="#method.allocated">allocated</a><a href="#method.apply_flags">apply_flags</a><a href="#method.atomic_new">atomic_new</a><a href="#method.atomic_new_slice">atomic_new_slice</a><a href="#method.atomic_new_uninit">atomic_new_uninit</a><a href="#method.available">available</a><a href="#method.clear">clear</a><a href="#method.close">close</a><a href="#method.commit">commit</a><a href="#method.commit_no_clear">commit_no_clear</a><a href="#method.contains">contains</a><a href="#method.dealloc">dealloc</a><a href="#method.deref">deref</a><a href="#method.deref_mut">deref_mut</a><a href="#method.deref_slice_unchecked">deref_slice_unchecked</a><a href="#method.deref_slice_unchecked_mut">deref_slice_unchecked_mut</a><a href="#method.discard">discard</a><a href="#method.drop_journal">drop_journal</a><a href="#method.drop_on_failure">drop_on_failure</a><a href="#method.end">end</a><a href="#method.format">format</a><a href="#method.free">free</a><a href="#method.free_nolog">free_nolog</a><a href="#method.free_slice">free_slice</a><a href="#method.gen">gen</a><a href="#method.get_mut_unchecked">get_mut_unchecked</a><a href="#method.get_unchecked">get_unchecked</a><a href="#method.is_open">is_open</a><a href="#method.journals">journals</a><a href="#method.journals_head">journals_head</a><a href="#method.log64">log64</a><a href="#method.name">name</a><a href="#method.new">new</a><a href="#method.new_slice">new_slice</a><a href="#method.new_uninit">new_uninit</a><a href="#method.new_uninit_for_layout">new_uninit_for_layout</a><a href="#method.off">off</a><a href="#method.off_unchecked">off_unchecked</a><a href="#method.open">open</a><a href="#method.open_no_root">open_no_root</a><a href="#method.perform">perform</a><a href="#method.print_info">print_info</a><a href="#method.recover">recover</a><a href="#method.rng">rng</a><a href="#method.rollback">rollback</a><a href="#method.rollback_no_clear">rollback_no_clear</a><a href="#method.size">size</a><a href="#method.start">start</a><a href="#method.transaction">transaction</a><a href="#method.used">used</a><a href="#method.valid">valid</a><a href="#method.zone">zone</a></div><a class="sidebar-title" href="#implementors">Implementors</a></div><p class="location"><a href="../index.html">corundum</a>::<wbr><a href="index.html">alloc</a></p><script>window.sidebarCurrent = {name: "MemPool", ty: "trait", relpath: ""};</script><script defer src="sidebar-items.js"></script></div></nav><div class="theme-picker"><button id="theme-picker" aria-label="Pick another theme!" aria-haspopup="menu"><img src="../../brush.svg" width="18" alt="Pick another theme!"></button><div id="theme-choices" role="menu"></div></div><script src="../../theme.js"></script><nav class="sub"><form class="search-form"><div class="search-container"><div><select id="crate-search"><option value="All crates">All crates</option></select><input class="search-input" name="search" disabled autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"></div><button type="button" class="help-button">?</button>
                <a id="settings-menu" href="../../settings.html"><img src="../../wheel.svg" width="18" alt="Change settings"></a></div></form></nav><section id="main" class="content"><h1 class="fqn"><span class="out-of-band"><span id="render-detail"><a id="toggle-all-docs" href="javascript:void(0)" title="collapse all docs">[<span class="inner">&#x2212;</span>]</a></span><a class="srclink" href="../../src/corundum/alloc/pool.rs.html#169-1192" title="goto source code">[src]</a></span><span class="in-band">Trait <a href="../index.html">corundum</a>::<wbr><a href="index.html">alloc</a>::<wbr><a class="trait" href="">MemPool</a></span></h1><div class="docblock type-decl hidden-by-usual-hider"><pre class="rust trait">pub unsafe trait MemPool <span class="where fmt-newline">where<br>&nbsp;&nbsp;&nbsp;&nbsp;Self: 'static + <a class="trait" href="https://doc.rust-lang.org/nightly/core/marker/trait.Sized.html" title="trait core::marker::Sized">Sized</a>,&nbsp;</span>{
    pub unsafe fn <a href="#tymethod.pre_alloc" class="fnname">pre_alloc</a>(size: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a>) -&gt; <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.tuple.html">(</a><a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.pointer.html">*mut </a><a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u8.html">u8</a>, <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u64.html">u64</a>, <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a>, <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a><a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.tuple.html">)</a>;
<div class="item-spacer"></div>    pub unsafe fn <a href="#tymethod.pre_dealloc" class="fnname">pre_dealloc</a>(ptr: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.pointer.html">*mut </a><a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u8.html">u8</a>, size: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a>) -&gt; <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a>;

    pub fn <a href="#method.name" class="fnname">name</a>() -&gt; &amp;'static <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.str.html">str</a> { ... }
<div class="item-spacer"></div>    pub fn <a href="#method.open_no_root" class="fnname">open_no_root</a>(_path: &amp;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.str.html">str</a>, _flags: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u32.html">u32</a>) -&gt; <a class="type" href="../../corundum/result/type.Result.html" title="type corundum::result::Result">Result</a>&lt;Self&gt; { ... }
<div class="item-spacer"></div>    pub unsafe fn <a href="#method.close" class="fnname">close</a>() -&gt; <a class="type" href="../../corundum/result/type.Result.html" title="type corundum::result::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.unit.html">()</a>&gt; { ... }
<div class="item-spacer"></div>    pub fn <a href="#method.zone" class="fnname">zone</a>(_off: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u64.html">u64</a>) -&gt; <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a> { ... }
<div class="item-spacer"></div>    pub fn <a href="#method.open" class="fnname">open</a>&lt;'a, U:&nbsp;'a + <a class="trait" href="../../corundum/trait.PSafe.html" title="trait corundum::PSafe">PSafe</a> + <a class="trait" href="../../corundum/cell/trait.RootObj.html" title="trait corundum::cell::RootObj">RootObj</a>&lt;Self&gt;&gt;(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_path: &amp;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.str.html">str</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_flags: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u32.html">u32</a><br>&nbsp;&nbsp;&nbsp;&nbsp;) -&gt; <a class="type" href="../../corundum/result/type.Result.html" title="type corundum::result::Result">Result</a>&lt;<a class="struct" href="../../corundum/cell/struct.RootCell.html" title="struct corundum::cell::RootCell">RootCell</a>&lt;'a, U, Self&gt;&gt; { ... }
<div class="item-spacer"></div>    pub fn <a href="#method.is_open" class="fnname">is_open</a>() -&gt; <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.bool.html">bool</a> { ... }
<div class="item-spacer"></div>    pub unsafe fn <a href="#method.format" class="fnname">format</a>(_path: &amp;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.str.html">str</a>) -&gt; <a class="type" href="../../corundum/result/type.Result.html" title="type corundum::result::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.unit.html">()</a>&gt; { ... }
<div class="item-spacer"></div>    pub unsafe fn <a href="#method.apply_flags" class="fnname">apply_flags</a>(path: &amp;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.str.html">str</a>, flags: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u32.html">u32</a>) -&gt; <a class="type" href="../../corundum/result/type.Result.html" title="type corundum::result::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.unit.html">()</a>&gt; { ... }
<div class="item-spacer"></div>    pub fn <a href="#method.allocated" class="fnname">allocated</a>(_off: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u64.html">u64</a>, _len: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a>) -&gt; <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.bool.html">bool</a> { ... }
<div class="item-spacer"></div>    pub unsafe fn <a href="#method.off_unchecked" class="fnname">off_unchecked</a>&lt;T:&nbsp;?<a class="trait" href="https://doc.rust-lang.org/nightly/core/marker/trait.Sized.html" title="trait core::marker::Sized">Sized</a>&gt;(x: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.pointer.html">*const T</a>) -&gt; <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u64.html">u64</a> { ... }
<div class="item-spacer"></div>    pub unsafe fn <a href="#method.get_unchecked" class="fnname">get_unchecked</a>&lt;'a, T:&nbsp;'a + ?<a class="trait" href="https://doc.rust-lang.org/nightly/core/marker/trait.Sized.html" title="trait core::marker::Sized">Sized</a>&gt;(off: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u64.html">u64</a>) -&gt; <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.reference.html">&amp;'a </a>T { ... }
<div class="item-spacer"></div>    pub unsafe fn <a href="#method.get_mut_unchecked" class="fnname">get_mut_unchecked</a>&lt;'a, T:&nbsp;'a + ?<a class="trait" href="https://doc.rust-lang.org/nightly/core/marker/trait.Sized.html" title="trait core::marker::Sized">Sized</a>&gt;(off: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u64.html">u64</a>) -&gt; <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.reference.html">&amp;'a mut </a>T { ... }
<div class="item-spacer"></div>    pub unsafe fn <a href="#method.deref_slice_unchecked" class="fnname">deref_slice_unchecked</a>&lt;'a, T:&nbsp;'a&gt;(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;off: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u64.html">u64</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;len: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a><br>&nbsp;&nbsp;&nbsp;&nbsp;) -&gt; <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.slice.html">&amp;'a [T]</a> { ... }
<div class="item-spacer"></div>    pub unsafe fn <a href="#method.deref_slice_unchecked_mut" class="fnname">deref_slice_unchecked_mut</a>&lt;'a, T:&nbsp;'a&gt;(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;off: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u64.html">u64</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;len: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a><br>&nbsp;&nbsp;&nbsp;&nbsp;) -&gt; <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.slice.html">&amp;'a mut [T]</a> { ... }
<div class="item-spacer"></div>    pub unsafe fn <a href="#method.deref" class="fnname">deref</a>&lt;'a, T:&nbsp;'a&gt;(off: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u64.html">u64</a>) -&gt; <a class="type" href="../../corundum/result/type.Result.html" title="type corundum::result::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.reference.html">&amp;'a </a>T&gt; { ... }
<div class="item-spacer"></div>    pub unsafe fn <a href="#method.deref_mut" class="fnname">deref_mut</a>&lt;'a, T:&nbsp;'a&gt;(off: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u64.html">u64</a>) -&gt; <a class="type" href="../../corundum/result/type.Result.html" title="type corundum::result::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.reference.html">&amp;'a mut </a>T&gt; { ... }
<div class="item-spacer"></div>    pub fn <a href="#method.off" class="fnname">off</a>&lt;T:&nbsp;?<a class="trait" href="https://doc.rust-lang.org/nightly/core/marker/trait.Sized.html" title="trait core::marker::Sized">Sized</a>&gt;(x: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.pointer.html">*const T</a>) -&gt; <a class="type" href="../../corundum/result/type.Result.html" title="type corundum::result::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u64.html">u64</a>&gt; { ... }
<div class="item-spacer"></div>    pub fn <a href="#method.rng" class="fnname">rng</a>() -&gt; <a class="struct" href="https://doc.rust-lang.org/nightly/core/ops/range/struct.Range.html" title="struct core::ops::range::Range">Range</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u64.html">u64</a>&gt; { ... }
<div class="item-spacer"></div>    pub fn <a href="#method.start" class="fnname">start</a>() -&gt; <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u64.html">u64</a> { ... }
<div class="item-spacer"></div>    pub fn <a href="#method.end" class="fnname">end</a>() -&gt; <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u64.html">u64</a> { ... }
<div class="item-spacer"></div>    pub fn <a href="#method.size" class="fnname">size</a>() -&gt; <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a> { ... }
<div class="item-spacer"></div>    pub fn <a href="#method.available" class="fnname">available</a>() -&gt; <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a> { ... }
<div class="item-spacer"></div>    pub fn <a href="#method.used" class="fnname">used</a>() -&gt; <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a> { ... }
<div class="item-spacer"></div>    pub fn <a href="#method.valid" class="fnname">valid</a>&lt;T:&nbsp;?<a class="trait" href="https://doc.rust-lang.org/nightly/core/marker/trait.Sized.html" title="trait core::marker::Sized">Sized</a>&gt;(p: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.pointer.html">*const T</a>) -&gt; <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.bool.html">bool</a> { ... }
<div class="item-spacer"></div>    pub fn <a href="#method.contains" class="fnname">contains</a>(addr: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u64.html">u64</a>) -&gt; <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.bool.html">bool</a> { ... }
<div class="item-spacer"></div>    pub unsafe fn <a href="#method.alloc" class="fnname">alloc</a>(size: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a>) -&gt; <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.tuple.html">(</a><a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.pointer.html">*mut </a><a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u8.html">u8</a>, <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u64.html">u64</a>, <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a><a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.tuple.html">)</a> { ... }
<div class="item-spacer"></div>    pub unsafe fn <a href="#method.dealloc" class="fnname">dealloc</a>(ptr: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.pointer.html">*mut </a><a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u8.html">u8</a>, size: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a>) { ... }
<div class="item-spacer"></div>    pub unsafe fn <a href="#method.log64" class="fnname">log64</a>(_off: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u64.html">u64</a>, _val: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u64.html">u64</a>, _zone: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a>) { ... }
<div class="item-spacer"></div>    pub unsafe fn <a href="#method.drop_on_failure" class="fnname">drop_on_failure</a>(_off: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u64.html">u64</a>, _len: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a>, _zone: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a>) { ... }
<div class="item-spacer"></div>    pub unsafe fn <a href="#method.perform" class="fnname">perform</a>(_zone: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a>) { ... }
<div class="item-spacer"></div>    pub unsafe fn <a href="#method.discard" class="fnname">discard</a>(_zone: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a>) { ... }
<div class="item-spacer"></div>    pub unsafe fn <a href="#method.alloc_zeroed" class="fnname">alloc_zeroed</a>(size: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a>) -&gt; <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.pointer.html">*mut </a><a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u8.html">u8</a> { ... }
<div class="item-spacer"></div>    pub unsafe fn <a href="#method.new" class="fnname">new</a>&lt;'a, T:&nbsp;<a class="trait" href="../../corundum/trait.PSafe.html" title="trait corundum::PSafe">PSafe</a> + 'a&gt;(x: T, j: &amp;<a class="struct" href="../../corundum/stm/journal/struct.Journal.html" title="struct corundum::stm::journal::Journal">Journal</a>&lt;Self&gt;) -&gt; <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.reference.html">&amp;'a mut </a>T { ... }
<div class="item-spacer"></div>    pub unsafe fn <a href="#method.new_slice" class="fnname">new_slice</a>&lt;'a, T:&nbsp;<a class="trait" href="../../corundum/trait.PSafe.html" title="trait corundum::PSafe">PSafe</a> + 'a&gt;(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.slice.html">&amp;'a [T]</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_journal: &amp;<a class="struct" href="../../corundum/stm/journal/struct.Journal.html" title="struct corundum::stm::journal::Journal">Journal</a>&lt;Self&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;) -&gt; <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.slice.html">&amp;'a mut [T]</a> { ... }
<div class="item-spacer"></div>    pub unsafe fn <a href="#method.atomic_new" class="fnname">atomic_new</a>&lt;'a, T:&nbsp;'a&gt;(x: T) -&gt; <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.tuple.html">(</a><a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.reference.html">&amp;'a mut </a>T, <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u64.html">u64</a>, <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a>, <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a><a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.tuple.html">)</a> { ... }
<div class="item-spacer"></div>    pub unsafe fn <a href="#method.atomic_new_slice" class="fnname">atomic_new_slice</a>&lt;'a, T:&nbsp;'a + <a class="trait" href="../../corundum/trait.PSafe.html" title="trait corundum::PSafe">PSafe</a>&gt;(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.slice.html">&amp;'a [T]</a><br>&nbsp;&nbsp;&nbsp;&nbsp;) -&gt; <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.tuple.html">(</a><a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.slice.html">&amp;'a mut [T]</a>, <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u64.html">u64</a>, <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a>, <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a><a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.tuple.html">)</a> { ... }
<div class="item-spacer"></div>    pub unsafe fn <a href="#method.new_uninit" class="fnname">new_uninit</a>&lt;'a, T:&nbsp;<a class="trait" href="../../corundum/trait.PSafe.html" title="trait corundum::PSafe">PSafe</a> + 'a&gt;(j: &amp;<a class="struct" href="../../corundum/stm/journal/struct.Journal.html" title="struct corundum::stm::journal::Journal">Journal</a>&lt;Self&gt;) -&gt; <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.reference.html">&amp;'a mut </a>T { ... }
<div class="item-spacer"></div>    pub unsafe fn <a href="#method.new_uninit_for_layout" class="fnname">new_uninit_for_layout</a>(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;size: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;journal: &amp;<a class="struct" href="../../corundum/stm/journal/struct.Journal.html" title="struct corundum::stm::journal::Journal">Journal</a>&lt;Self&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;) -&gt; <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.pointer.html">*mut </a><a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u8.html">u8</a> { ... }
<div class="item-spacer"></div>    pub unsafe fn <a href="#method.atomic_new_uninit" class="fnname">atomic_new_uninit</a>&lt;'a, T:&nbsp;'a&gt;(<br>&nbsp;&nbsp;&nbsp;&nbsp;) -&gt; <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.tuple.html">(</a><a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.reference.html">&amp;'a mut </a>T, <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u64.html">u64</a>, <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a>, <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a><a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.tuple.html">)</a> { ... }
<div class="item-spacer"></div>    pub unsafe fn <a href="#method.alloc_for_value" class="fnname">alloc_for_value</a>&lt;'a, T:&nbsp;?<a class="trait" href="https://doc.rust-lang.org/nightly/core/marker/trait.Sized.html" title="trait core::marker::Sized">Sized</a>&gt;(x: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.reference.html">&amp;</a>T) -&gt; <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.reference.html">&amp;'a mut </a>T { ... }
<div class="item-spacer"></div>    pub unsafe fn <a href="#method.free" class="fnname">free</a>&lt;'a, T:&nbsp;<a class="trait" href="../../corundum/trait.PSafe.html" title="trait corundum::PSafe">PSafe</a> + ?<a class="trait" href="https://doc.rust-lang.org/nightly/core/marker/trait.Sized.html" title="trait core::marker::Sized">Sized</a>&gt;(x: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.reference.html">&amp;mut </a>T) { ... }
<div class="item-spacer"></div>    pub unsafe fn <a href="#method.free_slice" class="fnname">free_slice</a>&lt;'a, T:&nbsp;<a class="trait" href="../../corundum/trait.PSafe.html" title="trait corundum::PSafe">PSafe</a>&gt;(x: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.slice.html">&amp;mut [T]</a>) { ... }
<div class="item-spacer"></div>    pub unsafe fn <a href="#method.free_nolog" class="fnname">free_nolog</a>&lt;'a, T:&nbsp;?<a class="trait" href="https://doc.rust-lang.org/nightly/core/marker/trait.Sized.html" title="trait core::marker::Sized">Sized</a>&gt;(x: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.reference.html">&amp;</a>T) { ... }
<div class="item-spacer"></div>    pub unsafe fn <a href="#method.drop_journal" class="fnname">drop_journal</a>(_journal: &amp;mut <a class="struct" href="../../corundum/stm/journal/struct.Journal.html" title="struct corundum::stm::journal::Journal">Journal</a>&lt;Self&gt;) { ... }
<div class="item-spacer"></div>    pub unsafe fn <a href="#method.journals_head" class="fnname">journals_head</a>() -&gt; &amp;'static <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u64.html">u64</a> { ... }
<div class="item-spacer"></div>    pub unsafe fn <a href="#method.journals" class="fnname">journals</a>&lt;T, F:&nbsp;<a class="trait" href="https://doc.rust-lang.org/nightly/core/ops/function/trait.Fn.html" title="trait core::ops::function::Fn">Fn</a>(&amp;mut <a class="struct" href="https://doc.rust-lang.org/nightly/std/collections/hash/map/struct.HashMap.html" title="struct std::collections::hash::map::HashMap">HashMap</a>&lt;<a class="struct" href="https://doc.rust-lang.org/nightly/std/thread/struct.ThreadId.html" title="struct std::thread::ThreadId">ThreadId</a>, <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.tuple.html">(</a><a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u64.html">u64</a>, <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.i32.html">i32</a><a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.tuple.html">)</a>&gt;) -&gt; T&gt;(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_: F<br>&nbsp;&nbsp;&nbsp;&nbsp;) -&gt; T { ... }
<div class="item-spacer"></div>    pub unsafe fn <a href="#method.recover" class="fnname">recover</a>() { ... }
<div class="item-spacer"></div>    pub unsafe fn <a href="#method.commit" class="fnname">commit</a>() { ... }
<div class="item-spacer"></div>    pub unsafe fn <a href="#method.commit_no_clear" class="fnname">commit_no_clear</a>() { ... }
<div class="item-spacer"></div>    pub unsafe fn <a href="#method.clear" class="fnname">clear</a>() { ... }
<div class="item-spacer"></div>    pub unsafe fn <a href="#method.rollback" class="fnname">rollback</a>() { ... }
<div class="item-spacer"></div>    pub unsafe fn <a href="#method.rollback_no_clear" class="fnname">rollback_no_clear</a>() { ... }
<div class="item-spacer"></div>    pub fn <a href="#method.transaction" class="fnname">transaction</a>&lt;T, F:&nbsp;<a class="trait" href="https://doc.rust-lang.org/nightly/core/ops/function/trait.FnOnce.html" title="trait core::ops::function::FnOnce">FnOnce</a>(&amp;<a class="struct" href="../../corundum/stm/journal/struct.Journal.html" title="struct corundum::stm::journal::Journal">Journal</a>&lt;Self&gt;) -&gt; T&gt;(body: F) -&gt; <a class="type" href="../../corundum/result/type.Result.html" title="type corundum::result::Result">Result</a>&lt;T&gt;<br>&nbsp;&nbsp;&nbsp; <span class="where">where<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;F: <a class="trait" href="../../corundum/trait.TxInSafe.html" title="trait corundum::TxInSafe">TxInSafe</a> + <a class="trait" href="https://doc.rust-lang.org/nightly/std/panic/trait.UnwindSafe.html" title="trait std::panic::UnwindSafe">UnwindSafe</a>,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;T: <a class="trait" href="../../corundum/trait.TxOutSafe.html" title="trait corundum::TxOutSafe">TxOutSafe</a></span>,
    { ... }
<div class="item-spacer"></div>    pub fn <a href="#method.gen" class="fnname">gen</a>() -&gt; <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u32.html">u32</a> { ... }
<div class="item-spacer"></div>    pub fn <a href="#method.print_info" class="fnname">print_info</a>() { ... }
}</pre></div><div class="docblock"><p>Persistent Memory Pool</p>
<p>This trait can be used to define a persistent memory pool type. The
methods of <code>MemPool</code> trait do not have a reference to self in order to make
sure that all information that it works with, including the virtual address
boundaries, are static. Therefore, all objects with the same memory
allocator will share a unique memory pool type. Having a strong set of type
checking rules, Rust prevents referencing from one memory pool to another.</p>
<p>To implement a new memory pool, you should define a new type with static
values, that implements <code>MemPool</code>. You may use <a href="../macro.static_inner_object.html"><code>static_inner_object!()</code></a>
to statically define allocator's inner data, and <a href="../macro.static_inner.html"><code>static_inner!()</code></a> to
access it. You may also use the default allocator using <a href="./default/macro.pool.html"><code>pool!()</code></a> which
creates a pool module with a default allocator of type <a href="./default/struct.BuddyAlloc.html"><code>BuddyAlloc</code></a>.</p>
<h1 id="examples" class="section-header"><a href="#examples">Examples</a></h1>
<p>The following example shows how to use <code>MemPool</code> to track allocations of a
single numerical object of type <code>i32</code>.</p>

<div class="example-wrap"><pre class="rust rust-example-rendered">
<span class="kw">use</span> <span class="ident">std</span>::<span class="ident">alloc</span>::{<span class="ident">alloc</span>,<span class="ident">dealloc</span>,<span class="ident">realloc</span>,<span class="ident">Layout</span>};

<span class="kw">struct</span> <span class="ident">TrackAlloc</span> {}

<span class="kw">unsafe</span> <span class="kw">impl</span> <span class="ident">MemPool</span> <span class="kw">for</span> <span class="ident">TrackAlloc</span> {
    <span class="kw">fn</span> <span class="ident">rng</span>() <span class="op">-</span><span class="op">&gt;</span> <span class="ident">Range</span><span class="op">&lt;</span><span class="ident">u64</span><span class="op">&gt;</span> { <span class="number">0</span>..<span class="ident">u64</span>::<span class="ident">MAX</span> }
    <span class="kw">unsafe</span> <span class="kw">fn</span> <span class="ident">pre_alloc</span>(<span class="ident">size</span>: <span class="ident">usize</span>) <span class="op">-</span><span class="op">&gt;</span> (<span class="kw-2">*</span><span class="kw-2">mut</span> <span class="ident">u8</span>, <span class="ident">u64</span>, <span class="ident">usize</span>, <span class="ident">usize</span>) {
        <span class="kw">let</span> <span class="ident">p</span> <span class="op">=</span> <span class="ident">alloc</span>(<span class="ident">Layout</span>::<span class="ident">from_size_align_unchecked</span>(<span class="ident">size</span>, <span class="number">4</span>));
        <span class="macro">println</span><span class="macro">!</span>(<span class="string">&quot;A block of {} bytes is allocated at {}&quot;</span>, <span class="ident">size</span>, <span class="ident">p</span> <span class="kw">as</span> <span class="ident">u64</span>);
        (<span class="ident">p</span>, <span class="ident">p</span> <span class="kw">as</span> <span class="ident">u64</span>, <span class="ident">size</span>, <span class="number">0</span>)
    }
    <span class="kw">unsafe</span> <span class="kw">fn</span> <span class="ident">pre_dealloc</span>(<span class="ident">p</span>: <span class="kw-2">*</span><span class="kw-2">mut</span> <span class="ident">u8</span>, <span class="ident">size</span>: <span class="ident">usize</span>) <span class="op">-</span><span class="op">&gt;</span> <span class="ident">usize</span> {
        <span class="macro">println</span><span class="macro">!</span>(<span class="string">&quot;A block of {} bytes at {} is deallocated&quot;</span>, <span class="ident">size</span>, <span class="ident">p</span> <span class="kw">as</span> <span class="ident">u64</span>);
        <span class="ident">dealloc</span>(<span class="ident">p</span>, <span class="ident">Layout</span>::<span class="ident">from_size_align_unchecked</span>(<span class="ident">size</span>, <span class="number">1</span>));
        <span class="number">0</span>
    }
}

<span class="kw">unsafe</span> {
    <span class="kw">let</span> (<span class="ident">p</span>, <span class="kw">_</span>, <span class="kw">_</span>) <span class="op">=</span> <span class="ident">TrackAlloc</span>::<span class="ident">alloc</span>(<span class="number">1</span>);
    <span class="kw-2">*</span><span class="ident">p</span> <span class="op">=</span> <span class="number">10</span>;
    <span class="macro">println</span><span class="macro">!</span>(<span class="string">&quot;loc {} contains {}&quot;</span>, <span class="ident">p</span> <span class="kw">as</span> <span class="ident">u64</span>, <span class="kw-2">*</span><span class="ident">p</span>);
    <span class="ident">TrackAlloc</span>::<span class="ident">dealloc</span>(<span class="ident">p</span>, <span class="number">1</span>);
}</pre></div>
<h1 id="safety" class="section-header"><a href="#safety">Safety</a></h1>
<p>This is the developer's responsibility to manually drop allocated objects.
One way for memory management is to use pointer wrappers that implement
<a href="https://doc.rust-lang.org/nightly/core/ops/drop/trait.Drop.html" title="Drop"><code>Drop</code></a> trait and deallocate the object on drop. Unsafe
methods does not guarantee persistent memory safety.</p>
<p><code>pmem</code> crate provides <code>Pbox</code>, <code>Prc</code>, and <code>Parc</code> for memory management using
RAII. They internally use the unsafe methods.</p>
</div><h2 id="required-methods" class="small-section-header">Required methods<a href="#required-methods" class="anchor"></a></h2><div class="methods"><h3 id="tymethod.pre_alloc" class="method"><code>pub unsafe fn <a href="#tymethod.pre_alloc" class="fnname">pre_alloc</a>(size: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a>) -&gt; <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.tuple.html">(</a><a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.pointer.html">*mut </a><a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u8.html">u8</a>, <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u64.html">u64</a>, <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a>, <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a><a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.tuple.html">)</a></code><a class="srclink" href="../../src/corundum/alloc/pool.rs.html#647" title="goto source code">[src]</a></h3><div class="docblock"><p>Prepares allocation without performing it</p>
<p>This function is used internally for low-level atomicity in memory
allocation. As an example, please see <a href="#method.drop_on_failure"><code>drop_on_failure</code></a>.</p>
<p>It returns a 4-tuple:
1. Raw pointer
2. Offset
3. Size
4. Zone index</p>
<h1 id="examples-1" class="section-header"><a href="#examples-1">Examples</a></h1>
<div class="example-wrap"><pre class="rust rust-example-rendered">
<span class="kw">unsafe</span> {
    <span class="kw">let</span> (<span class="ident">ptr</span>, <span class="kw">_</span>, <span class="kw">_</span>, <span class="ident">z</span>) <span class="op">=</span> <span class="ident">P</span>::<span class="ident">pre_alloc</span>(<span class="number">8</span>);
    <span class="kw-2">*</span><span class="ident">ptr</span> <span class="op">=</span> <span class="number">10</span>;
    <span class="ident">P</span>::<span class="ident">perform</span>(<span class="ident">z</span>);
}</pre></div>
</div><h3 id="tymethod.pre_dealloc" class="method"><code>pub unsafe fn <a href="#tymethod.pre_dealloc" class="fnname">pre_dealloc</a>(ptr: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.pointer.html">*mut </a><a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u8.html">u8</a>, size: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a>) -&gt; <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a></code><a class="srclink" href="../../src/corundum/alloc/pool.rs.html#674" title="goto source code">[src]</a></h3><div class="docblock"><p>Prepares deallocation without performing it</p>
<p>This function is used internally for low-level atomicity in memory
allocation. As an example, please see <a href="#method.drop_on_failure"><code>drop_on_failure</code></a>.</p>
<p>It returns the zone in which the deallocation happens.</p>
<h1 id="examples-2" class="section-header"><a href="#examples-2">Examples</a></h1>
<div class="example-wrap"><pre class="rust rust-example-rendered">
<span class="kw">unsafe</span> {
    <span class="kw">let</span> (<span class="ident">ptr</span>, <span class="kw">_</span>, <span class="kw">_</span>) <span class="op">=</span> <span class="ident">P</span>::<span class="ident">alloc</span>(<span class="number">8</span>);
    <span class="kw-2">*</span><span class="ident">ptr</span> <span class="op">=</span> <span class="number">10</span>;
    <span class="kw">let</span> <span class="ident">zone</span> <span class="op">=</span> <span class="ident">P</span>::<span class="ident">pre_dealloc</span>(<span class="ident">ptr</span>, <span class="number">8</span>);
    <span class="macro">assert_eq</span><span class="macro">!</span>(<span class="kw-2">*</span><span class="ident">ptr</span>, <span class="number">10</span>);
    <span class="ident">P</span>::<span class="ident">perform</span>(<span class="ident">zone</span>);
    <span class="macro">assert_ne</span><span class="macro">!</span>(<span class="kw-2">*</span><span class="ident">ptr</span>, <span class="number">10</span>);
}</pre></div>
</div></div><span class="loading-content">Loading content...</span><h2 id="provided-methods" class="small-section-header">Provided methods<a href="#provided-methods" class="anchor"></a></h2><div class="methods"><h3 id="method.name" class="method"><code>pub fn <a href="#method.name" class="fnname">name</a>() -&gt; &amp;'static <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.str.html">str</a></code><a class="srclink" href="../../src/corundum/alloc/pool.rs.html#174-176" title="goto source code">[src]</a></h3><div class="docblock"><p>Returns the name of the pool type</p>
</div><h3 id="method.open_no_root" class="method"><code>pub fn <a href="#method.open_no_root" class="fnname">open_no_root</a>(_path: &amp;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.str.html">str</a>, _flags: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u32.html">u32</a>) -&gt; <a class="type" href="../../corundum/result/type.Result.html" title="type corundum::result::Result">Result</a>&lt;Self&gt;</code><a class="srclink" href="../../src/corundum/alloc/pool.rs.html#192-194" title="goto source code">[src]</a></h3><div class="docblock"><p>Opens a new pool without any root object. This function is for testing 
and is not useful in real applications as none of the allocated
objects in persistent region is durable. The reason is that they are not
reachable from a root object as it doesn't exists. All objects can live
only in the scope of a transaction.</p>
<h1 id="flags" class="section-header"><a href="#flags">Flags</a></h1>
<ul>
<li>O_C:    create a memory pool file if not exists</li>
<li>O_F:    format the memory pool file</li>
<li>O_CNE:  create a memory pool file if not exists</li>
<li>O_CF:   create and format a new memory pool file</li>
<li>O_CFNE: create and format a memory pool file only if not exists</li>
</ul>
<p>See <a href="./open_flags/index.html"><code>open_flags</code></a> for more options.</p>
</div><h3 id="method.close" class="method"><code>pub unsafe fn <a href="#method.close" class="fnname">close</a>() -&gt; <a class="type" href="../../corundum/result/type.Result.html" title="type corundum::result::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.unit.html">()</a>&gt;</code><a class="srclink" href="../../src/corundum/alloc/pool.rs.html#201-203" title="goto source code">[src]</a></h3><div class="docblock"><p>Commits all changes and clears the logs for all threads</p>
<p>This method should be called while dropping the <code>MemPool</code> object to
make sure that all uncommitted changes outside transactions, such as
reference counters, are persistent.</p>
</div><h3 id="method.zone" class="method"><code>pub fn <a href="#method.zone" class="fnname">zone</a>(_off: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u64.html">u64</a>) -&gt; <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a></code><a class="srclink" href="../../src/corundum/alloc/pool.rs.html#207-209" title="goto source code">[src]</a></h3><div class="docblock"><p>Returns the zone index corresponding to a given address</p>
</div><h3 id="method.open" class="method"><code>pub fn <a href="#method.open" class="fnname">open</a>&lt;'a, U:&nbsp;'a + <a class="trait" href="../../corundum/trait.PSafe.html" title="trait corundum::PSafe">PSafe</a> + <a class="trait" href="../../corundum/cell/trait.RootObj.html" title="trait corundum::cell::RootObj">RootObj</a>&lt;Self&gt;&gt;(<br>&nbsp;&nbsp;&nbsp;&nbsp;_path: &amp;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.str.html">str</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;_flags: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u32.html">u32</a><br>) -&gt; <a class="type" href="../../corundum/result/type.Result.html" title="type corundum::result::Result">Result</a>&lt;<a class="struct" href="../../corundum/cell/struct.RootCell.html" title="struct corundum::cell::RootCell">RootCell</a>&lt;'a, U, Self&gt;&gt;</code><a class="srclink" href="../../src/corundum/alloc/pool.rs.html#311-316" title="goto source code">[src]</a></h3><div class="docblock"><p>Opens a pool and retrieves the root object</p>
<p>The root type should implement <a href="../stm/trait.RootObj.html"><code>RootObj</code></a> trait in order to create a
root object on its absence. This function [creates and] returns an
immutable reference to the root object. The pool remains open as long as
the root object is in the scope. Like other persistent objects, the root
object is immutable and it is modifiable via interior mutability.</p>
<h1 id="flags-1" class="section-header"><a href="#flags-1">Flags</a></h1>
<ul>
<li>O_C:    create a memory pool file if not exists</li>
<li>O_F:    format the memory pool file</li>
<li>O_CNE:  create a memory pool file if not exists</li>
<li>O_CF:   create and format a new memory pool file</li>
<li>O_CFNE: create and format a memory pool file only if not exists</li>
</ul>
<p>See <a href="./open_flags/index.html"><code>open_flags</code></a> for more options.</p>
<h1 id="examples-3" class="section-header"><a href="#examples-3">Examples</a></h1>
<div class="example-wrap"><pre class="rust rust-example-rendered">
<span class="kw">use</span> <span class="ident">corundum</span>::<span class="ident">default</span>::<span class="kw-2">*</span>;

<span class="kw">let</span> <span class="ident">root</span> <span class="op">=</span> <span class="ident">BuddyAlloc</span>::<span class="ident">open</span>::<span class="op">&lt;</span><span class="ident">i32</span><span class="op">&gt;</span>(<span class="string">&quot;foo.pool&quot;</span>, <span class="ident">O_CF</span>).<span class="ident">unwrap</span>();

<span class="macro">assert_eq</span><span class="macro">!</span>(<span class="kw-2">*</span><span class="ident">root</span>, <span class="ident">i32</span>::<span class="ident">default</span>());</pre></div>
<h2 id="single-thread-shared-root-object" class="section-header"><a href="#single-thread-shared-root-object">Single-thread Shared Root Object</a></h2>
<p><a href="../prc/struct.Prc.html"><code>Prc</code></a><code>&lt;</code><a href="./default/type.PCell.html"><code>PCell</code></a><code>&lt;T&gt;&gt;</code> can be used in order to have a mutable shared
root object, as follows.</p>

<div class="example-wrap"><pre class="rust rust-example-rendered">
<span class="kw">use</span> <span class="ident">corundum</span>::<span class="ident">default</span>::<span class="kw-2">*</span>;

<span class="kw">type</span> <span class="ident">Root</span> <span class="op">=</span> <span class="ident">Prc</span><span class="op">&lt;</span><span class="ident">PCell</span><span class="op">&lt;</span><span class="ident">i32</span><span class="op">&gt;</span><span class="op">&gt;</span>;

<span class="kw">let</span> <span class="ident">root</span> <span class="op">=</span> <span class="ident">BuddyAlloc</span>::<span class="ident">open</span>::<span class="op">&lt;</span><span class="ident">Root</span><span class="op">&gt;</span>(<span class="string">&quot;foo.pool&quot;</span>, <span class="ident">O_CF</span>).<span class="ident">unwrap</span>();

<span class="kw">let</span> <span class="ident">data</span> <span class="op">=</span> <span class="ident">root</span>.<span class="ident">get</span>();

<span class="kw">if</span> <span class="ident">data</span> <span class="op">=</span><span class="op">=</span> <span class="ident">i32</span>::<span class="ident">default</span>() {
    <span class="macro">println</span><span class="macro">!</span>(<span class="string">&quot;Initializing data&quot;</span>);
    <span class="comment">// This block runs only once to initialize the root object</span>
    <span class="ident">transaction</span>(<span class="op">|</span><span class="ident">j</span><span class="op">|</span> {
        <span class="ident">root</span>.<span class="ident">set</span>(<span class="number">10</span>, <span class="ident">j</span>);
    }).<span class="ident">unwrap</span>();
}

<span class="macro">assert_eq</span><span class="macro">!</span>(<span class="ident">root</span>.<span class="ident">get</span>(), <span class="number">10</span>);</pre></div>
<h2 id="thread-safe-root-object" class="section-header"><a href="#thread-safe-root-object">Thread-safe Root Object</a></h2>
<p>If you need a thread-safe root object, you may want to wrap the root object
in <a href="../sync/parc/struct.Parc.html"><code>Parc</code></a><code>&lt;</code><a href="./default/type.PMutex.html"><code>PMutex</code></a><code>&lt;T&gt;&gt;</code>, as shown in the example below:</p>

<div class="example-wrap"><pre class="rust rust-example-rendered">
<span class="kw">use</span> <span class="ident">corundum</span>::<span class="ident">default</span>::<span class="kw-2">*</span>;
<span class="kw">use</span> <span class="ident">std</span>::<span class="ident">thread</span>;

<span class="kw">type</span> <span class="ident">Root</span> <span class="op">=</span> <span class="ident">Parc</span><span class="op">&lt;</span><span class="ident">PMutex</span><span class="op">&lt;</span><span class="ident">i32</span><span class="op">&gt;</span><span class="op">&gt;</span>;

<span class="kw">let</span> <span class="ident">root</span> <span class="op">=</span> <span class="ident">BuddyAlloc</span>::<span class="ident">open</span>::<span class="op">&lt;</span><span class="ident">Root</span><span class="op">&gt;</span>(<span class="string">&quot;foo.pool&quot;</span>, <span class="ident">O_CF</span>).<span class="ident">unwrap</span>();

<span class="kw">let</span> <span class="kw-2">mut</span> <span class="ident">threads</span> <span class="op">=</span> <span class="macro">vec</span><span class="macro">!</span>();

<span class="kw">for</span> <span class="kw">_</span> <span class="kw">in</span> <span class="number">0</span>..<span class="number">10</span> {
    <span class="kw">let</span> <span class="ident">root</span> <span class="op">=</span> <span class="ident">Parc</span>::<span class="ident">demote</span>(<span class="kw-2">&amp;</span><span class="ident">root</span>);
    <span class="ident">threads</span>.<span class="ident">push</span>(<span class="ident">thread</span>::<span class="ident">spawn</span>(<span class="kw">move</span> <span class="op">|</span><span class="op">|</span> {
        <span class="ident">transaction</span>(<span class="op">|</span><span class="ident">j</span><span class="op">|</span> {
            <span class="kw">if</span> <span class="kw">let</span> <span class="prelude-val">Some</span>(<span class="ident">root</span>) <span class="op">=</span> <span class="ident">root</span>.<span class="ident">promote</span>(<span class="ident">j</span>) {
                <span class="kw">let</span> <span class="kw-2">mut</span> <span class="ident">root</span> <span class="op">=</span> <span class="ident">root</span>.<span class="ident">lock</span>(<span class="ident">j</span>);
                <span class="kw-2">*</span><span class="ident">root</span> <span class="op">+</span><span class="op">=</span> <span class="number">10</span>;
            }
        }).<span class="ident">unwrap</span>();
    }));
}

<span class="kw">for</span> <span class="ident">thread</span> <span class="kw">in</span> <span class="ident">threads</span> {
    <span class="ident">thread</span>.<span class="ident">join</span>().<span class="ident">unwrap</span>();
}

<span class="ident">transaction</span>(<span class="op">|</span><span class="ident">j</span><span class="op">|</span> {
    <span class="kw">let</span> <span class="ident">data</span> <span class="op">=</span> <span class="ident">root</span>.<span class="ident">lock</span>(<span class="ident">j</span>);
    <span class="macro">assert_eq</span><span class="macro">!</span>(<span class="kw-2">*</span><span class="ident">data</span> <span class="op">%</span> <span class="number">100</span>, <span class="number">0</span>);
}).<span class="ident">unwrap</span>();</pre></div>
<h1 id="errors" class="section-header"><a href="#errors">Errors</a></h1>
<ul>
<li>A demote memory pool (e.g. <code>Heap</code>) doesn't have a root object.</li>
<li>The pool should be open before accessing the root object.</li>
</ul>
</div><h3 id="method.is_open" class="method"><code>pub fn <a href="#method.is_open" class="fnname">is_open</a>() -&gt; <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.bool.html">bool</a></code><a class="srclink" href="../../src/corundum/alloc/pool.rs.html#319-321" title="goto source code">[src]</a></h3><div class="docblock"><p>Returns true if the pool is open</p>
</div><h3 id="method.format" class="method"><code>pub unsafe fn <a href="#method.format" class="fnname">format</a>(_path: &amp;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.str.html">str</a>) -&gt; <a class="type" href="../../corundum/result/type.Result.html" title="type corundum::result::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.unit.html">()</a>&gt;</code><a class="srclink" href="../../src/corundum/alloc/pool.rs.html#324-326" title="goto source code">[src]</a></h3><div class="docblock"><p>Formats the memory pool file</p>
</div><h3 id="method.apply_flags" class="method"><code>pub unsafe fn <a href="#method.apply_flags" class="fnname">apply_flags</a>(path: &amp;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.str.html">str</a>, flags: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u32.html">u32</a>) -&gt; <a class="type" href="../../corundum/result/type.Result.html" title="type corundum::result::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.unit.html">()</a>&gt;</code><a class="srclink" href="../../src/corundum/alloc/pool.rs.html#329-351" title="goto source code">[src]</a></h3><div class="docblock"><p>Applies open pool flags</p>
</div><h3 id="method.allocated" class="method"><code>pub fn <a href="#method.allocated" class="fnname">allocated</a>(_off: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u64.html">u64</a>, _len: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a>) -&gt; <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.bool.html">bool</a></code><a class="srclink" href="../../src/corundum/alloc/pool.rs.html#355-357" title="goto source code">[src]</a></h3><div class="docblock"><p>Indicates if the given offset is allocated</p>
</div><h3 id="method.off_unchecked" class="method"><code>pub unsafe fn <a href="#method.off_unchecked" class="fnname">off_unchecked</a>&lt;T:&nbsp;?<a class="trait" href="https://doc.rust-lang.org/nightly/core/marker/trait.Sized.html" title="trait core::marker::Sized">Sized</a>&gt;(x: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.pointer.html">*const T</a>) -&gt; <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u64.html">u64</a></code><a class="srclink" href="../../src/corundum/alloc/pool.rs.html#365-367" title="goto source code">[src]</a></h3><div class="docblock"><p>Translates raw pointers to memory offsets</p>
<h1 id="safety-1" class="section-header"><a href="#safety-1">Safety</a></h1>
<p>The raw pointer should be in the valid range</p>
</div><h3 id="method.get_unchecked" class="method"><code>pub unsafe fn <a href="#method.get_unchecked" class="fnname">get_unchecked</a>&lt;'a, T:&nbsp;'a + ?<a class="trait" href="https://doc.rust-lang.org/nightly/core/marker/trait.Sized.html" title="trait core::marker::Sized">Sized</a>&gt;(off: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u64.html">u64</a>) -&gt; <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.reference.html">&amp;'a </a>T</code><a class="srclink" href="../../src/corundum/alloc/pool.rs.html#375-388" title="goto source code">[src]</a></h3><div class="docblock"><p>Acquires a reference pointer to the object</p>
<h1 id="safety-2" class="section-header"><a href="#safety-2">Safety</a></h1>
<p>The offset should be in the valid address range</p>
</div><h3 id="method.get_mut_unchecked" class="method"><code>pub unsafe fn <a href="#method.get_mut_unchecked" class="fnname">get_mut_unchecked</a>&lt;'a, T:&nbsp;'a + ?<a class="trait" href="https://doc.rust-lang.org/nightly/core/marker/trait.Sized.html" title="trait core::marker::Sized">Sized</a>&gt;(off: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u64.html">u64</a>) -&gt; <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.reference.html">&amp;'a mut </a>T</code><a class="srclink" href="../../src/corundum/alloc/pool.rs.html#397-410" title="goto source code">[src]</a></h3><div class="docblock"><p>Acquires a mutable reference to the object</p>
<h1 id="safety-3" class="section-header"><a href="#safety-3">Safety</a></h1>
<p>The offset should be in the valid address range</p>
</div><h3 id="method.deref_slice_unchecked" class="method"><code>pub unsafe fn <a href="#method.deref_slice_unchecked" class="fnname">deref_slice_unchecked</a>&lt;'a, T:&nbsp;'a&gt;(off: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u64.html">u64</a>, len: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a>) -&gt; <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.slice.html">&amp;'a [T]</a></code><a class="srclink" href="../../src/corundum/alloc/pool.rs.html#418-447" title="goto source code">[src]</a></h3><div class="docblock"><p>Acquires a reference to the slice</p>
<h1 id="safety-4" class="section-header"><a href="#safety-4">Safety</a></h1>
<p>The offset should be in the valid address range</p>
</div><h3 id="method.deref_slice_unchecked_mut" class="method"><code>pub unsafe fn <a href="#method.deref_slice_unchecked_mut" class="fnname">deref_slice_unchecked_mut</a>&lt;'a, T:&nbsp;'a&gt;(<br>&nbsp;&nbsp;&nbsp;&nbsp;off: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u64.html">u64</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;len: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a><br>) -&gt; <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.slice.html">&amp;'a mut [T]</a></code><a class="srclink" href="../../src/corundum/alloc/pool.rs.html#455-484" title="goto source code">[src]</a></h3><div class="docblock"><p>Acquires a mutable reference to the slice</p>
<h1 id="safety-5" class="section-header"><a href="#safety-5">Safety</a></h1>
<p>The offset should be in the valid address range</p>
</div><h3 id="method.deref" class="method"><code>pub unsafe fn <a href="#method.deref" class="fnname">deref</a>&lt;'a, T:&nbsp;'a&gt;(off: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u64.html">u64</a>) -&gt; <a class="type" href="../../corundum/result/type.Result.html" title="type corundum::result::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.reference.html">&amp;'a </a>T&gt;</code><a class="srclink" href="../../src/corundum/alloc/pool.rs.html#488-494" title="goto source code">[src]</a></h3><div class="docblock"><p>Acquires a reference to the object</p>
</div><h3 id="method.deref_mut" class="method"><code>pub unsafe fn <a href="#method.deref_mut" class="fnname">deref_mut</a>&lt;'a, T:&nbsp;'a&gt;(off: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u64.html">u64</a>) -&gt; <a class="type" href="../../corundum/result/type.Result.html" title="type corundum::result::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.reference.html">&amp;'a mut </a>T&gt;</code><a class="srclink" href="../../src/corundum/alloc/pool.rs.html#498-504" title="goto source code">[src]</a></h3><div class="docblock"><p>Acquires a mutable reference pointer to the object</p>
</div><h3 id="method.off" class="method"><code>pub fn <a href="#method.off" class="fnname">off</a>&lt;T:&nbsp;?<a class="trait" href="https://doc.rust-lang.org/nightly/core/marker/trait.Sized.html" title="trait core::marker::Sized">Sized</a>&gt;(x: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.pointer.html">*const T</a>) -&gt; <a class="type" href="../../corundum/result/type.Result.html" title="type corundum::result::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u64.html">u64</a>&gt;</code><a class="srclink" href="../../src/corundum/alloc/pool.rs.html#508-514" title="goto source code">[src]</a></h3><div class="docblock"><p>Translates raw pointers to memory offsets</p>
</div><h3 id="method.rng" class="method"><code>pub fn <a href="#method.rng" class="fnname">rng</a>() -&gt; <a class="struct" href="https://doc.rust-lang.org/nightly/core/ops/range/struct.Range.html" title="struct core::ops::range::Range">Range</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u64.html">u64</a>&gt;</code><a class="srclink" href="../../src/corundum/alloc/pool.rs.html#517-519" title="goto source code">[src]</a></h3><div class="docblock"><p>Valid Virtual Address Range</p>
</div><h3 id="method.start" class="method"><code>pub fn <a href="#method.start" class="fnname">start</a>() -&gt; <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u64.html">u64</a></code><a class="srclink" href="../../src/corundum/alloc/pool.rs.html#523-525" title="goto source code">[src]</a></h3><div class="docblock"><p>Start of virtual address range</p>
</div><h3 id="method.end" class="method"><code>pub fn <a href="#method.end" class="fnname">end</a>() -&gt; <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u64.html">u64</a></code><a class="srclink" href="../../src/corundum/alloc/pool.rs.html#529-531" title="goto source code">[src]</a></h3><div class="docblock"><p>End of virtual address range</p>
</div><h3 id="method.size" class="method"><code>pub fn <a href="#method.size" class="fnname">size</a>() -&gt; <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a></code><a class="srclink" href="../../src/corundum/alloc/pool.rs.html#534-536" title="goto source code">[src]</a></h3><div class="docblock"><p>Total size of the memory pool</p>
</div><h3 id="method.available" class="method"><code>pub fn <a href="#method.available" class="fnname">available</a>() -&gt; <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a></code><a class="srclink" href="../../src/corundum/alloc/pool.rs.html#539-541" title="goto source code">[src]</a></h3><div class="docblock"><p>Available space in the pool</p>
</div><h3 id="method.used" class="method"><code>pub fn <a href="#method.used" class="fnname">used</a>() -&gt; <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a></code><a class="srclink" href="../../src/corundum/alloc/pool.rs.html#544-546" title="goto source code">[src]</a></h3><div class="docblock"><p>Total occupied space</p>
</div><h3 id="method.valid" class="method"><code>pub fn <a href="#method.valid" class="fnname">valid</a>&lt;T:&nbsp;?<a class="trait" href="https://doc.rust-lang.org/nightly/core/marker/trait.Sized.html" title="trait core::marker::Sized">Sized</a>&gt;(p: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.pointer.html">*const T</a>) -&gt; <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.bool.html">bool</a></code><a class="srclink" href="../../src/corundum/alloc/pool.rs.html#550-556" title="goto source code">[src]</a></h3><div class="docblock"><p>Checks if the reference <code>p</code> belongs to this pool</p>
</div><h3 id="method.contains" class="method"><code>pub fn <a href="#method.contains" class="fnname">contains</a>(addr: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u64.html">u64</a>) -&gt; <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.bool.html">bool</a></code><a class="srclink" href="../../src/corundum/alloc/pool.rs.html#571-574" title="goto source code">[src]</a></h3><div class="docblock"><p>Checks if <code>addr</code> is in the valid address range if this allocator</p>
<p><code>addr</code> contains the scalar of a virtual address. If you have a raw
fat pointer of type T, you can obtain its virtual address by converting
it into a thin pointer and then <code>u64</code>.</p>
<h1 id="examples-4" class="section-header"><a href="#examples-4">Examples</a></h1>
<div class="example-wrap"><pre class="rust rust-example-rendered">
<span class="kw">let</span> <span class="ident">p</span> <span class="op">=</span> <span class="ident">Box</span>::<span class="ident">new</span>(<span class="number">1</span>);
<span class="macro">println</span><span class="macro">!</span>(<span class="string">&quot;Address {:#x} contains value &#39;{}&#39;&quot;</span>, <span class="ident">p</span>.<span class="ident">as_ref</span>() <span class="kw">as</span> <span class="kw-2">*</span><span class="kw">const</span> <span class="kw">_</span> <span class="kw">as</span> <span class="ident">u64</span>, <span class="kw-2">*</span><span class="ident">p</span>);</pre></div>
</div><h3 id="method.alloc" class="method"><code>pub unsafe fn <a href="#method.alloc" class="fnname">alloc</a>(size: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a>) -&gt; <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.tuple.html">(</a><a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.pointer.html">*mut </a><a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u8.html">u8</a>, <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u64.html">u64</a>, <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a><a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.tuple.html">)</a></code><a class="srclink" href="../../src/corundum/alloc/pool.rs.html#595-600" title="goto source code">[src]</a></h3><div class="docblock"><p>Allocate memory as described by the given <code>size</code>.</p>
<p>Returns a pointer to newly-allocated memory.</p>
<h1 id="safety-6" class="section-header"><a href="#safety-6">Safety</a></h1>
<p>This function is unsafe because undefined behavior can result
if the caller does not ensure that <code>size</code> has non-zero.
The allocated block of memory may or may not be initialized.
Using <code>alloc</code> may lead to memory leak if the transaction fails
after this function successfully returns. To allocate memory in
a failure-atomic manner, use <a href="#method.pre_alloc"><code>pre_alloc</code></a>, <a href="../stm/struct.Log.html#method.drop_on_failure"><code>Log::drop_on_failure</code></a>,
and <a href="#method.pre_alloc"><code>perform</code></a> functions respectively.</p>
</div><h3 id="method.dealloc" class="method"><code>pub unsafe fn <a href="#method.dealloc" class="fnname">dealloc</a>(ptr: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.pointer.html">*mut </a><a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u8.html">u8</a>, size: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a>)</code><a class="srclink" href="../../src/corundum/alloc/pool.rs.html#617-619" title="goto source code">[src]</a></h3><div class="docblock"><p>Deallocate the block of memory at the given <code>ptr</code> pointer with the
given <code>size</code>.</p>
<h1 id="safety-7" class="section-header"><a href="#safety-7">Safety</a></h1>
<p>This function is unsafe because undefined behavior can result if the
caller does not ensure all of the following:</p>
<ul>
<li>
<p><code>ptr</code> must denote a block of memory currently allocated via this
allocator,</p>
</li>
<li>
<p><code>size</code> must be the same size that was used to allocate that block
of memory.</p>
</li>
</ul>
</div><h3 id="method.log64" class="method"><code>pub unsafe fn <a href="#method.log64" class="fnname">log64</a>(_off: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u64.html">u64</a>, _val: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u64.html">u64</a>, _zone: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a>)</code><a class="srclink" href="../../src/corundum/alloc/pool.rs.html#682-684" title="goto source code">[src]</a></h3><div class="docblock"><p>Adds a low-level log to update as 64-bit <code>obj</code> to <code>val</code> when 
<a href="#method.perform"><code>perform()</code></a> is called. As an example, please see <a href="../stm/struct.Log.html#method.set"><code>Log::set()</code></a>.</p>
</div><h3 id="method.drop_on_failure" class="method"><code>pub unsafe fn <a href="#method.drop_on_failure" class="fnname">drop_on_failure</a>(_off: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u64.html">u64</a>, _len: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a>, _zone: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a>)</code><a class="srclink" href="../../src/corundum/alloc/pool.rs.html#729" title="goto source code">[src]</a></h3><div class="docblock"><p>Adds a low-level <code>DropOnFailure</code> log to perform inside the allocator. 
This is internally used to atomically allocate a new objects. Calling
<a href="#method.perform"><code>perform()</code></a> drops these logs.</p>
<h1 id="examples-5" class="section-header"><a href="#examples-5">Examples</a></h1>
<div class="example-wrap"><pre class="rust rust-example-rendered">
<span class="kw">unsafe</span> {
    <span class="comment">// Prepare an allocation. The allocation is not durable yet. In case</span>
    <span class="comment">// of a crash, the prepared allocated space is gone. It is fine</span>
    <span class="comment">// because it has not been used. The `pre_` and `perform` functions</span>
    <span class="comment">// form a low-level atomic section.</span>
    <span class="kw">let</span> (<span class="ident">obj</span>, <span class="ident">off</span>, <span class="ident">len</span>, <span class="ident">zone</span>) <span class="op">=</span> <span class="ident">P</span>::<span class="ident">pre_alloc</span>(<span class="number">1</span>);
 
    <span class="comment">// Create a low-level DropOnFailure log. This log is going to be used</span>
    <span class="comment">// when a crash happens while performing the changes made by the</span>
    <span class="comment">// preparation functions. If a crash happens before that, these logs</span>
    <span class="comment">// will be discarded.</span>
    <span class="ident">P</span>::<span class="ident">drop_on_failure</span>(<span class="ident">off</span>, <span class="ident">len</span>, <span class="ident">zone</span>);
     
    <span class="comment">// It is fine to work with the prepared raw pointer. All changes in</span>
    <span class="comment">// the low-level atomic section are considered as part of the</span>
    <span class="comment">// allocation and will be gone in case of a crash, as the allocation</span>
    <span class="comment">// will be dropped.</span>
    <span class="kw-2">*</span><span class="ident">obj</span> <span class="op">=</span> <span class="number">20</span>;
 
    <span class="comment">// Transaction ends here. The perform function sets the `operating`</span>
    <span class="comment">// flag to show that the prepared changes are being materialized.</span>
    <span class="comment">// This flag remains set until the end of materialization. In case</span>
    <span class="comment">// of a crash while operating, the recovery procedure first continues</span>
    <span class="comment">// the materialization, and then uses the `DropOnFailure` logs to</span>
    <span class="comment">// reclaim the allocation. `perform` function realizes the changes</span>
    <span class="comment">// made by the `pre_` function on the given memory zone.</span>
    <span class="ident">P</span>::<span class="ident">perform</span>(<span class="ident">zone</span>);
}</pre></div>
</div><h3 id="method.perform" class="method"><code>pub unsafe fn <a href="#method.perform" class="fnname">perform</a>(_zone: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a>)</code><a class="srclink" href="../../src/corundum/alloc/pool.rs.html#740" title="goto source code">[src]</a></h3><div class="docblock"><p>Performs the prepared operations</p>
<p>It materializes the changes made by <a href="#method.pre_alloc"><code>pre_alloc</code></a>,
<a href="#method.pre_dealloc"><code>pre_dealloc</code></a>, and
<a href="#method.pre_realloc"><code>pre_realloc</code></a>. See <a href="#method.drop_on_failure"><code>drop_on_failure</code></a> for more
details.</p>
</div><h3 id="method.discard" class="method"><code>pub unsafe fn <a href="#method.discard" class="fnname">discard</a>(_zone: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a>)</code><a class="srclink" href="../../src/corundum/alloc/pool.rs.html#751" title="goto source code">[src]</a></h3><div class="docblock"><p>Discards the prepared operations</p>
<p>Discards the changes made by <a href="#method.pre_alloc"><code>pre_alloc</code></a>,
<a href="#method.pre_dealloc"><code>pre_dealloc</code></a>, and
<a href="#method.pre_realloc"><code>pre_realloc</code></a>.  See <a href="#method.drop_on_failure"><code>drop_on_failure</code></a> for more
details.</p>
</div><h3 id="method.alloc_zeroed" class="method"><code>pub unsafe fn <a href="#method.alloc_zeroed" class="fnname">alloc_zeroed</a>(size: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a>) -&gt; <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.pointer.html">*mut </a><a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u8.html">u8</a></code><a class="srclink" href="../../src/corundum/alloc/pool.rs.html#771-777" title="goto source code">[src]</a></h3><div class="docblock"><p>Behaves like <code>alloc</code>, but also ensures that the contents
are set to zero before being returned.</p>
<h1 id="safety-8" class="section-header"><a href="#safety-8">Safety</a></h1>
<p>This function is unsafe for the same reasons that <code>alloc</code> is.
However the allocated block of memory is guaranteed to be initialized.</p>
<h1 id="errors-1" class="section-header"><a href="#errors-1">Errors</a></h1>
<p>Returning a null pointer indicates that either memory is exhausted
or <code>size</code> does not meet allocator's size constraints, just as in <code>alloc</code>.</p>
<p>Clients wishing to abort computation in response to an
allocation error are encouraged to call the <a href="../../alloc/alloc/fn.handle_alloc_error.html"><code>handle_alloc_error</code></a> function,
rather than directly invoking <code>panic!</code> or similar.</p>
</div><h3 id="method.new" class="method"><code>pub unsafe fn <a href="#method.new" class="fnname">new</a>&lt;'a, T:&nbsp;<a class="trait" href="../../corundum/trait.PSafe.html" title="trait corundum::PSafe">PSafe</a> + 'a&gt;(x: T, j: &amp;<a class="struct" href="../../corundum/stm/journal/struct.Journal.html" title="struct corundum::stm::journal::Journal">Journal</a>&lt;Self&gt;) -&gt; <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.reference.html">&amp;'a mut </a>T</code><a class="srclink" href="../../src/corundum/alloc/pool.rs.html#780-788" title="goto source code">[src]</a></h3><div class="docblock"><p>Allocates new memory and then places <code>x</code> into it with <code>DropOnFailure</code> log</p>
</div><h3 id="method.new_slice" class="method"><code>pub unsafe fn <a href="#method.new_slice" class="fnname">new_slice</a>&lt;'a, T:&nbsp;<a class="trait" href="../../corundum/trait.PSafe.html" title="trait corundum::PSafe">PSafe</a> + 'a&gt;(<br>&nbsp;&nbsp;&nbsp;&nbsp;x: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.slice.html">&amp;'a [T]</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;_journal: &amp;<a class="struct" href="../../corundum/stm/journal/struct.Journal.html" title="struct corundum::stm::journal::Journal">Journal</a>&lt;Self&gt;<br>) -&gt; <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.slice.html">&amp;'a mut [T]</a></code><a class="srclink" href="../../src/corundum/alloc/pool.rs.html#791-800" title="goto source code">[src]</a></h3><div class="docblock"><p>Allocates a new slice and then places <code>x</code> into it with <code>DropOnAbort</code> log</p>
</div><h3 id="method.atomic_new" class="method"><code>pub unsafe fn <a href="#method.atomic_new" class="fnname">atomic_new</a>&lt;'a, T:&nbsp;'a&gt;(x: T) -&gt; <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.tuple.html">(</a><a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.reference.html">&amp;'a mut </a>T, <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u64.html">u64</a>, <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a>, <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a><a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.tuple.html">)</a></code><a class="srclink" href="../../src/corundum/alloc/pool.rs.html#803-820" title="goto source code">[src]</a></h3><div class="docblock"><p>Allocates new memory and then places <code>x</code> into it without realizing the allocation</p>
</div><h3 id="method.atomic_new_slice" class="method"><code>pub unsafe fn <a href="#method.atomic_new_slice" class="fnname">atomic_new_slice</a>&lt;'a, T:&nbsp;'a + <a class="trait" href="../../corundum/trait.PSafe.html" title="trait corundum::PSafe">PSafe</a>&gt;(<br>&nbsp;&nbsp;&nbsp;&nbsp;x: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.slice.html">&amp;'a [T]</a><br>) -&gt; <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.tuple.html">(</a><a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.slice.html">&amp;'a mut [T]</a>, <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u64.html">u64</a>, <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a>, <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a><a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.tuple.html">)</a></code><a class="srclink" href="../../src/corundum/alloc/pool.rs.html#823-842" title="goto source code">[src]</a></h3><div class="docblock"><p>Allocates new memory and then places <code>x</code> into it without realizing the allocation</p>
</div><h3 id="method.new_uninit" class="method"><code>pub unsafe fn <a href="#method.new_uninit" class="fnname">new_uninit</a>&lt;'a, T:&nbsp;<a class="trait" href="../../corundum/trait.PSafe.html" title="trait corundum::PSafe">PSafe</a> + 'a&gt;(j: &amp;<a class="struct" href="../../corundum/stm/journal/struct.Journal.html" title="struct corundum::stm::journal::Journal">Journal</a>&lt;Self&gt;) -&gt; <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.reference.html">&amp;'a mut </a>T</code><a class="srclink" href="../../src/corundum/alloc/pool.rs.html#845-851" title="goto source code">[src]</a></h3><div class="docblock"><p>Allocates new memory without copying data</p>
</div><h3 id="method.new_uninit_for_layout" class="method"><code>pub unsafe fn <a href="#method.new_uninit_for_layout" class="fnname">new_uninit_for_layout</a>(<br>&nbsp;&nbsp;&nbsp;&nbsp;size: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;journal: &amp;<a class="struct" href="../../corundum/stm/journal/struct.Journal.html" title="struct corundum::stm::journal::Journal">Journal</a>&lt;Self&gt;<br>) -&gt; <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.pointer.html">*mut </a><a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u8.html">u8</a></code><a class="srclink" href="../../src/corundum/alloc/pool.rs.html#854-866" title="goto source code">[src]</a></h3><div class="docblock"><p>Allocates new memory without copying data</p>
</div><h3 id="method.atomic_new_uninit" class="method"><code>pub unsafe fn <a href="#method.atomic_new_uninit" class="fnname">atomic_new_uninit</a>&lt;'a, T:&nbsp;'a&gt;() -&gt; <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.tuple.html">(</a><a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.reference.html">&amp;'a mut </a>T, <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u64.html">u64</a>, <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a>, <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a><a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.tuple.html">)</a></code><a class="srclink" href="../../src/corundum/alloc/pool.rs.html#869-881" title="goto source code">[src]</a></h3><div class="docblock"><p>Allocates new memory without copying data and realizing the allocation</p>
</div><h3 id="method.alloc_for_value" class="method"><code>pub unsafe fn <a href="#method.alloc_for_value" class="fnname">alloc_for_value</a>&lt;'a, T:&nbsp;?<a class="trait" href="https://doc.rust-lang.org/nightly/core/marker/trait.Sized.html" title="trait core::marker::Sized">Sized</a>&gt;(x: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.reference.html">&amp;</a>T) -&gt; <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.reference.html">&amp;'a mut </a>T</code><a class="srclink" href="../../src/corundum/alloc/pool.rs.html#884-894" title="goto source code">[src]</a></h3><div class="docblock"><p>Allocates new memory for value <code>x</code></p>
</div><h3 id="method.free" class="method"><code>pub unsafe fn <a href="#method.free" class="fnname">free</a>&lt;'a, T:&nbsp;<a class="trait" href="../../corundum/trait.PSafe.html" title="trait corundum::PSafe">PSafe</a> + ?<a class="trait" href="https://doc.rust-lang.org/nightly/core/marker/trait.Sized.html" title="trait core::marker::Sized">Sized</a>&gt;(x: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.reference.html">&amp;mut </a>T)</code><a class="srclink" href="../../src/corundum/alloc/pool.rs.html#897-906" title="goto source code">[src]</a></h3><div class="docblock"><p>Creates a <code>DropOnCommit</code> log for the value <code>x</code></p>
</div><h3 id="method.free_slice" class="method"><code>pub unsafe fn <a href="#method.free_slice" class="fnname">free_slice</a>&lt;'a, T:&nbsp;<a class="trait" href="../../corundum/trait.PSafe.html" title="trait corundum::PSafe">PSafe</a>&gt;(x: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.slice.html">&amp;mut [T]</a>)</code><a class="srclink" href="../../src/corundum/alloc/pool.rs.html#909-919" title="goto source code">[src]</a></h3><div class="docblock"><p>Creates a <code>DropOnCommit</code> log for the value <code>x</code></p>
</div><h3 id="method.free_nolog" class="method"><code>pub unsafe fn <a href="#method.free_nolog" class="fnname">free_nolog</a>&lt;'a, T:&nbsp;?<a class="trait" href="https://doc.rust-lang.org/nightly/core/marker/trait.Sized.html" title="trait core::marker::Sized">Sized</a>&gt;(x: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.reference.html">&amp;</a>T)</code><a class="srclink" href="../../src/corundum/alloc/pool.rs.html#922-926" title="goto source code">[src]</a></h3><div class="docblock"><p>Frees the allocation for value <code>x</code> immediately</p>
</div><h3 id="method.drop_journal" class="method"><code>pub unsafe fn <a href="#method.drop_journal" class="fnname">drop_journal</a>(_journal: &amp;mut <a class="struct" href="../../corundum/stm/journal/struct.Journal.html" title="struct corundum::stm::journal::Journal">Journal</a>&lt;Self&gt;)</code><a class="srclink" href="../../src/corundum/alloc/pool.rs.html#929" title="goto source code">[src]</a></h3><div class="docblock"><p>Drops a <code>journal</code> from memory</p>
</div><h3 id="method.journals_head" class="method"><code>pub unsafe fn <a href="#method.journals_head" class="fnname">journals_head</a>() -&gt; &amp;'static <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u64.html">u64</a></code><a class="srclink" href="../../src/corundum/alloc/pool.rs.html#932" title="goto source code">[src]</a></h3><div class="docblock"><p>Returns a reference to the offset of the first journal</p>
</div><h3 id="method.journals" class="method"><code>pub unsafe fn <a href="#method.journals" class="fnname">journals</a>&lt;T, F:&nbsp;<a class="trait" href="https://doc.rust-lang.org/nightly/core/ops/function/trait.Fn.html" title="trait core::ops::function::Fn">Fn</a>(&amp;mut <a class="struct" href="https://doc.rust-lang.org/nightly/std/collections/hash/map/struct.HashMap.html" title="struct std::collections::hash::map::HashMap">HashMap</a>&lt;<a class="struct" href="https://doc.rust-lang.org/nightly/std/thread/struct.ThreadId.html" title="struct std::thread::ThreadId">ThreadId</a>, <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.tuple.html">(</a><a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u64.html">u64</a>, <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.i32.html">i32</a><a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.tuple.html">)</a>&gt;) -&gt; T&gt;(<br>&nbsp;&nbsp;&nbsp;&nbsp;_: F<br>) -&gt; T</code><a class="srclink" href="../../src/corundum/alloc/pool.rs.html#935-937" title="goto source code">[src]</a></h3><div class="docblock"><p>Runs a closure with a mutable reference to a thread-&gt;journal HashMap</p>
</div><h3 id="method.recover" class="method"><code>pub unsafe fn <a href="#method.recover" class="fnname">recover</a>()</code><a class="srclink" href="../../src/corundum/alloc/pool.rs.html#940-942" title="goto source code">[src]</a></h3><div class="docblock"><p>Recovers from a crash</p>
</div><h3 id="method.commit" class="method"><code>pub unsafe fn <a href="#method.commit" class="fnname">commit</a>()</code><a class="srclink" href="../../src/corundum/alloc/pool.rs.html#955-968" title="goto source code">[src]</a></h3><div class="docblock"><p>Commits all changes and clears the logs for one thread</p>
<p>If the transaction is nested, it postpones the commit to the top most
transaction.</p>
<h1 id="safety-9" class="section-header"><a href="#safety-9">Safety</a></h1>
<p>This function is for internal use and should not be called elsewhere.</p>
</div><h3 id="method.commit_no_clear" class="method"><code>pub unsafe fn <a href="#method.commit_no_clear" class="fnname">commit_no_clear</a>()</code><a class="srclink" href="../../src/corundum/alloc/pool.rs.html#980-991" title="goto source code">[src]</a></h3><div class="docblock"><p>Commits all changes without clearing the logs</p>
<p>If the transaction is nested, it postpones the commit to the top most
transaction.</p>
<h1 id="safety-10" class="section-header"><a href="#safety-10">Safety</a></h1>
<p>This function is for internal use and should not be called elsewhere.</p>
</div><h3 id="method.clear" class="method"><code>pub unsafe fn <a href="#method.clear" class="fnname">clear</a>()</code><a class="srclink" href="../../src/corundum/alloc/pool.rs.html#1003-1013" title="goto source code">[src]</a></h3><div class="docblock"><p>Clears the logs</p>
<p>If the transaction is nested, it postpones the clear to the top most
transaction.</p>
<h1 id="safety-11" class="section-header"><a href="#safety-11">Safety</a></h1>
<p>This function is for internal use and should not be called elsewhere.</p>
</div><h3 id="method.rollback" class="method"><code>pub unsafe fn <a href="#method.rollback" class="fnname">rollback</a>()</code><a class="srclink" href="../../src/corundum/alloc/pool.rs.html#1025-1041" title="goto source code">[src]</a></h3><div class="docblock"><p>Discards all changes and clears the logs</p>
<p>If the transaction is nested, it propagates the panic upto the top most
transaction to make all of them tainted.</p>
<h1 id="safety-12" class="section-header"><a href="#safety-12">Safety</a></h1>
<p>This function is for internal use and should not be called elsewhere.</p>
</div><h3 id="method.rollback_no_clear" class="method"><code>pub unsafe fn <a href="#method.rollback_no_clear" class="fnname">rollback_no_clear</a>()</code><a class="srclink" href="../../src/corundum/alloc/pool.rs.html#1053-1063" title="goto source code">[src]</a></h3><div class="docblock"><p>Discards all changes without clearing the logs</p>
<p>If the transaction is nested, it propagates the panic upto the top most
transaction to make all of them tainted.</p>
<h1 id="safety-13" class="section-header"><a href="#safety-13">Safety</a></h1>
<p>This function is for internal use and should not be called elsewhere.</p>
</div><h3 id="method.transaction" class="method"><code>pub fn <a href="#method.transaction" class="fnname">transaction</a>&lt;T, F:&nbsp;<a class="trait" href="https://doc.rust-lang.org/nightly/core/ops/function/trait.FnOnce.html" title="trait core::ops::function::FnOnce">FnOnce</a>(&amp;<a class="struct" href="../../corundum/stm/journal/struct.Journal.html" title="struct corundum::stm::journal::Journal">Journal</a>&lt;Self&gt;) -&gt; T&gt;(body: F) -&gt; <a class="type" href="../../corundum/result/type.Result.html" title="type corundum::result::Result">Result</a>&lt;T&gt; <span class="where fmt-newline">where<br>&nbsp;&nbsp;&nbsp;&nbsp;F: <a class="trait" href="../../corundum/trait.TxInSafe.html" title="trait corundum::TxInSafe">TxInSafe</a> + <a class="trait" href="https://doc.rust-lang.org/nightly/std/panic/trait.UnwindSafe.html" title="trait std::panic::UnwindSafe">UnwindSafe</a>,<br>&nbsp;&nbsp;&nbsp;&nbsp;T: <a class="trait" href="../../corundum/trait.TxOutSafe.html" title="trait corundum::TxOutSafe">TxOutSafe</a>,&nbsp;</span></code><a class="srclink" href="../../src/corundum/alloc/pool.rs.html#1108-1179" title="goto source code">[src]</a></h3><div class="docblock"><p>Executes commands atomically with respect to system crashes</p>
<p>The <code>transaction</code> function takes a closure with one argument of type
<code>&amp;Journal&lt;Self&gt;</code>. Before running the closure, it atomically creates a
<a href="../stm/journal/struct.Journal.html"><code>Journal</code></a> object, if required, and prepares an immutable reference to
it. Since there is no other safe way to create a <code>Journal</code> object, it
ensures that every function taking an argument of type <code>&amp;Journal&lt;P&gt;</code> is
enforced to be invoked from a transaction.</p>
<p>The captured types are bounded to be <a href="../trait.TxInSafe.html"><code>TxInSafe</code></a>, unless explicitly
asserted otherwise using <a href="../struct.AssertTxInSafe.html"><code>AssertTxInSafe</code></a> type wrapper. This
guarantees the demote state consistency, as well as the persistent
state.</p>
<p>The returned type should be <a href="../trait.TxOutSafe.html"><code>TxOutSafe</code></a>. This prevents sending out
unreachable persistent objects. The only way out of a transaction for
a persistent object is to be reachable by the root object.</p>
<h1 id="examples-6" class="section-header"><a href="#examples-6">Examples</a></h1>
<div class="example-wrap"><pre class="rust rust-example-rendered">
<span class="kw">use</span> <span class="ident">corundum</span>::<span class="ident">default</span>::<span class="kw-2">*</span>;
 
<span class="kw">type</span> <span class="ident">P</span> <span class="op">=</span> <span class="ident">BuddyAlloc</span>;
 
<span class="kw">let</span> <span class="ident">root</span> <span class="op">=</span> <span class="ident">P</span>::<span class="ident">open</span>::<span class="op">&lt;</span><span class="ident">PCell</span><span class="op">&lt;</span><span class="ident">i32</span><span class="op">&gt;</span><span class="op">&gt;</span>(<span class="string">&quot;foo.pool&quot;</span>, <span class="ident">O_CF</span>).<span class="ident">unwrap</span>();
 
<span class="kw">let</span> <span class="ident">old</span> <span class="op">=</span> <span class="ident">root</span>.<span class="ident">get</span>();
<span class="kw">let</span> <span class="ident">new</span> <span class="op">=</span> <span class="ident">BuddyAlloc</span>::<span class="ident">transaction</span>(<span class="op">|</span><span class="ident">j</span><span class="op">|</span> {
    <span class="ident">root</span>.<span class="ident">set</span>(<span class="ident">root</span>.<span class="ident">get</span>() <span class="op">+</span> <span class="number">1</span>, <span class="ident">j</span>);
    <span class="ident">root</span>.<span class="ident">get</span>()
}).<span class="ident">unwrap</span>();
 
<span class="macro">assert_eq</span><span class="macro">!</span>(<span class="ident">new</span>, <span class="ident">old</span> <span class="op">+</span> <span class="number">1</span>);</pre></div>
</div><h3 id="method.gen" class="method"><code>pub fn <a href="#method.gen" class="fnname">gen</a>() -&gt; <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u32.html">u32</a></code><a class="srclink" href="../../src/corundum/alloc/pool.rs.html#1181-1183" title="goto source code">[src]</a></h3><h3 id="method.print_info" class="method"><code>pub fn <a href="#method.print_info" class="fnname">print_info</a>()</code><a class="srclink" href="../../src/corundum/alloc/pool.rs.html#1186" title="goto source code">[src]</a></h3><div class="docblock"><p>Prints memory information</p>
</div></div><span class="loading-content">Loading content...</span><h2 id="implementors" class="small-section-header">Implementors<a href="#implementors" class="anchor"></a></h2><div class="item-list" id="implementors-list"><h3 id="impl-MemPool" class="impl"><code class="in-band">impl MemPool for <a class="struct" href="../../corundum/alloc/heap/struct.Heap.html" title="struct corundum::alloc::heap::Heap">Heap</a></code><a href="#impl-MemPool" class="anchor"></a><a class="srclink" href="../../src/corundum/alloc/heap.rs.html#26-177" title="goto source code">[src]</a></h3><div class="impl-items"><h4 id="method.name-1" class="method hidden"><code>pub fn <a href="#method.name-1" class="fnname">name</a>() -&gt; &amp;'static <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.str.html">str</a></code><a class="srclink" href="../../src/corundum/alloc/heap.rs.html#27-29" title="goto source code">[src]</a></h4><h4 id="method.rng-1" class="method hidden"><code>pub fn <a href="#method.rng-1" class="fnname">rng</a>() -&gt; <a class="struct" href="https://doc.rust-lang.org/nightly/core/ops/range/struct.Range.html" title="struct core::ops::range::Range">Range</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u64.html">u64</a>&gt;</code><a class="srclink" href="../../src/corundum/alloc/heap.rs.html#32-34" title="goto source code">[src]</a></h4><h4 id="method.pre_alloc" class="method hidden"><code>pub unsafe fn <a href="#method.pre_alloc" class="fnname">pre_alloc</a>(size: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a>) -&gt; <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.tuple.html">(</a><a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.pointer.html">*mut </a><a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u8.html">u8</a>, <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u64.html">u64</a>, <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a>, <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a><a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.tuple.html">)</a></code><a class="srclink" href="../../src/corundum/alloc/heap.rs.html#37-42" title="goto source code">[src]</a></h4><h4 id="method.pre_dealloc" class="method hidden"><code>pub unsafe fn <a href="#method.pre_dealloc" class="fnname">pre_dealloc</a>(ptr: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.pointer.html">*mut </a><a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u8.html">u8</a>, size: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a>) -&gt; <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a></code><a class="srclink" href="../../src/corundum/alloc/heap.rs.html#45-49" title="goto source code">[src]</a></h4><h4 id="method.allocated-1" class="method hidden"><code>pub fn <a href="#method.allocated-1" class="fnname">allocated</a>(off: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u64.html">u64</a>, _len: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a>) -&gt; <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.bool.html">bool</a></code><a class="srclink" href="../../src/corundum/alloc/heap.rs.html#73-79" title="goto source code">[src]</a></h4><h4 id="method.log64-1" class="method hidden"><code>pub unsafe fn <a href="#method.log64-1" class="fnname">log64</a>(obj: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u64.html">u64</a>, val: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u64.html">u64</a>, _: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a>)</code><a class="srclink" href="../../src/corundum/alloc/heap.rs.html#81-87" title="goto source code">[src]</a></h4><h4 id="method.drop_on_failure-1" class="method hidden"><code>pub unsafe fn <a href="#method.drop_on_failure-1" class="fnname">drop_on_failure</a>(_off: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u64.html">u64</a>, _len: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a>, _: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a>)</code><a class="srclink" href="../../src/corundum/alloc/heap.rs.html#89" title="goto source code">[src]</a></h4><h4 id="method.perform-1" class="method hidden"><code>pub unsafe fn <a href="#method.perform-1" class="fnname">perform</a>(_: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a>)</code><a class="srclink" href="../../src/corundum/alloc/heap.rs.html#91-103" title="goto source code">[src]</a></h4><h4 id="method.discard-1" class="method hidden"><code>pub unsafe fn <a href="#method.discard-1" class="fnname">discard</a>(_: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a>)</code><a class="srclink" href="../../src/corundum/alloc/heap.rs.html#105-111" title="goto source code">[src]</a></h4><h4 id="method.open_no_root-1" class="method hidden"><code>pub fn <a href="#method.open_no_root-1" class="fnname">open_no_root</a>(_path: &amp;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.str.html">str</a>, _flags: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u32.html">u32</a>) -&gt; <a class="type" href="../../corundum/result/type.Result.html" title="type corundum::result::Result">Result</a>&lt;Self&gt;</code><a class="srclink" href="../../src/corundum/alloc/heap.rs.html#113-115" title="goto source code">[src]</a></h4><h4 id="method.open-1" class="method hidden"><code>pub fn <a href="#method.open-1" class="fnname">open</a>&lt;'a, U:&nbsp;'a + <a class="trait" href="../../corundum/trait.PSafe.html" title="trait corundum::PSafe">PSafe</a> + <a class="trait" href="../../corundum/cell/trait.RootObj.html" title="trait corundum::cell::RootObj">RootObj</a>&lt;Self&gt;&gt;(<br>&nbsp;&nbsp;&nbsp;&nbsp;path: &amp;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.str.html">str</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;flags: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u32.html">u32</a><br>) -&gt; <a class="type" href="../../corundum/result/type.Result.html" title="type corundum::result::Result">Result</a>&lt;<a class="struct" href="../../corundum/cell/struct.RootCell.html" title="struct corundum::cell::RootCell">RootCell</a>&lt;'a, U, Self&gt;&gt;</code><a class="srclink" href="../../src/corundum/alloc/heap.rs.html#118-136" title="goto source code">[src]</a></h4><h4 id="method.is_open-1" class="method hidden"><code>pub fn <a href="#method.is_open-1" class="fnname">is_open</a>() -&gt; <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.bool.html">bool</a></code><a class="srclink" href="../../src/corundum/alloc/heap.rs.html#138-140" title="goto source code">[src]</a></h4><h4 id="method.format-1" class="method hidden"><code>pub unsafe fn <a href="#method.format-1" class="fnname">format</a>(_path: &amp;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.str.html">str</a>) -&gt; <a class="type" href="../../corundum/result/type.Result.html" title="type corundum::result::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.unit.html">()</a>&gt;</code><a class="srclink" href="../../src/corundum/alloc/heap.rs.html#142-144" title="goto source code">[src]</a></h4><h4 id="method.size-1" class="method hidden"><code>pub fn <a href="#method.size-1" class="fnname">size</a>() -&gt; <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a></code><a class="srclink" href="../../src/corundum/alloc/heap.rs.html#146-148" title="goto source code">[src]</a></h4><h4 id="method.available-1" class="method hidden"><code>pub fn <a href="#method.available-1" class="fnname">available</a>() -&gt; <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a></code><a class="srclink" href="../../src/corundum/alloc/heap.rs.html#150-152" title="goto source code">[src]</a></h4><h4 id="method.recover-1" class="method hidden"><code>pub unsafe fn <a href="#method.recover-1" class="fnname">recover</a>()</code><a class="srclink" href="../../src/corundum/alloc/heap.rs.html#154" title="goto source code">[src]</a></h4><h4 id="method.drop_journal-1" class="method hidden"><code>pub unsafe fn <a href="#method.drop_journal-1" class="fnname">drop_journal</a>(journal: &amp;mut <a class="type" href="../../corundum/alloc/heap/type.Journal.html" title="type corundum::alloc::heap::Journal">Journal</a>)</code><a class="srclink" href="../../src/corundum/alloc/heap.rs.html#156-160" title="goto source code">[src]</a></h4><h4 id="method.journals-1" class="method hidden"><code>pub unsafe fn <a href="#method.journals-1" class="fnname">journals</a>&lt;T, F:&nbsp;<a class="trait" href="https://doc.rust-lang.org/nightly/core/ops/function/trait.Fn.html" title="trait core::ops::function::Fn">Fn</a>(&amp;mut <a class="struct" href="https://doc.rust-lang.org/nightly/std/collections/hash/map/struct.HashMap.html" title="struct std::collections::hash::map::HashMap">HashMap</a>&lt;<a class="struct" href="https://doc.rust-lang.org/nightly/std/thread/struct.ThreadId.html" title="struct std::thread::ThreadId">ThreadId</a>, <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.tuple.html">(</a><a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u64.html">u64</a>, <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.i32.html">i32</a><a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.tuple.html">)</a>&gt;) -&gt; T&gt;(<br>&nbsp;&nbsp;&nbsp;&nbsp;f: F<br>) -&gt; T</code><a class="srclink" href="../../src/corundum/alloc/heap.rs.html#162-167" title="goto source code">[src]</a></h4><h4 id="method.journals_head-1" class="method hidden"><code>pub unsafe fn <a href="#method.journals_head-1" class="fnname">journals_head</a>() -&gt; &amp;'static <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u64.html">u64</a></code><a class="srclink" href="../../src/corundum/alloc/heap.rs.html#169-172" title="goto source code">[src]</a></h4><h4 id="method.close-1" class="method hidden"><code>pub unsafe fn <a href="#method.close-1" class="fnname">close</a>() -&gt; <a class="type" href="../../corundum/result/type.Result.html" title="type corundum::result::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.unit.html">()</a>&gt;</code><a class="srclink" href="../../src/corundum/alloc/heap.rs.html#174-176" title="goto source code">[src]</a></h4></div><h3 id="impl-MemPool-1" class="impl"><code class="in-band">impl MemPool for <a class="struct" href="../../corundum/default/struct.BuddyAlloc.html" title="struct corundum::default::BuddyAlloc">BuddyAlloc</a></code><a href="#impl-MemPool-1" class="anchor"></a><a class="srclink" href="../../src/corundum/lib.rs.html#164" title="goto source code">[src]</a></h3><div class="impl-items"><h4 id="method.name-2" class="method hidden"><code>pub fn <a href="#method.name-2" class="fnname">name</a>() -&gt; &amp;'static <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.str.html">str</a></code><a class="srclink" href="../../src/corundum/lib.rs.html#164" title="goto source code">[src]</a></h4><h4 id="method.format-2" class="method"><code>pub unsafe fn <a href="#method.format-2" class="fnname">format</a>(filename: &amp;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.str.html">str</a>) -&gt; <a class="type" href="../../corundum/result/type.Result.html" title="type corundum::result::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.unit.html">()</a>&gt;</code><a class="srclink" href="../../src/corundum/lib.rs.html#164" title="goto source code">[src]</a></h4><div class="docblock"><p>Formats the image file</p>
</div><h4 id="method.gen-1" class="method hidden"><code>pub fn <a href="#method.gen-1" class="fnname">gen</a>() -&gt; <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u32.html">u32</a></code><a class="srclink" href="../../src/corundum/lib.rs.html#164" title="goto source code">[src]</a></h4><h4 id="method.size-2" class="method hidden"><code>pub fn <a href="#method.size-2" class="fnname">size</a>() -&gt; <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a></code><a class="srclink" href="../../src/corundum/lib.rs.html#164" title="goto source code">[src]</a></h4><h4 id="method.available-2" class="method hidden"><code>pub fn <a href="#method.available-2" class="fnname">available</a>() -&gt; <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a></code><a class="srclink" href="../../src/corundum/lib.rs.html#164" title="goto source code">[src]</a></h4><h4 id="method.used-1" class="method hidden"><code>pub fn <a href="#method.used-1" class="fnname">used</a>() -&gt; <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a></code><a class="srclink" href="../../src/corundum/lib.rs.html#164" title="goto source code">[src]</a></h4><h4 id="method.rng-2" class="method hidden"><code>pub fn <a href="#method.rng-2" class="fnname">rng</a>() -&gt; <a class="struct" href="https://doc.rust-lang.org/nightly/core/ops/range/struct.Range.html" title="struct core::ops::range::Range">Range</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u64.html">u64</a>&gt;</code><a class="srclink" href="../../src/corundum/lib.rs.html#164" title="goto source code">[src]</a></h4><h4 id="method.start-1" class="method hidden"><code>pub fn <a href="#method.start-1" class="fnname">start</a>() -&gt; <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u64.html">u64</a></code><a class="srclink" href="../../src/corundum/lib.rs.html#164" title="goto source code">[src]</a></h4><h4 id="method.end-1" class="method hidden"><code>pub fn <a href="#method.end-1" class="fnname">end</a>() -&gt; <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u64.html">u64</a></code><a class="srclink" href="../../src/corundum/lib.rs.html#164" title="goto source code">[src]</a></h4><h4 id="method.pre_alloc-1" class="method hidden"><code>pub unsafe fn <a href="#method.pre_alloc-1" class="fnname">pre_alloc</a>(size: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a>) -&gt; <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.tuple.html">(</a><a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.pointer.html">*mut </a><a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u8.html">u8</a>, <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u64.html">u64</a>, <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a>, <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a><a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.tuple.html">)</a></code><a class="srclink" href="../../src/corundum/lib.rs.html#164" title="goto source code">[src]</a></h4><h4 id="method.pre_dealloc-1" class="method hidden"><code>pub unsafe fn <a href="#method.pre_dealloc-1" class="fnname">pre_dealloc</a>(ptr: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.pointer.html">*mut </a><a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u8.html">u8</a>, size: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a>) -&gt; <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a></code><a class="srclink" href="../../src/corundum/lib.rs.html#164" title="goto source code">[src]</a></h4><h4 id="method.log64-2" class="method hidden"><code>pub unsafe fn <a href="#method.log64-2" class="fnname">log64</a>(off: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u64.html">u64</a>, val: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u64.html">u64</a>, z: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a>)</code><a class="srclink" href="../../src/corundum/lib.rs.html#164" title="goto source code">[src]</a></h4><h4 id="method.drop_on_failure-2" class="method hidden"><code>pub unsafe fn <a href="#method.drop_on_failure-2" class="fnname">drop_on_failure</a>(off: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u64.html">u64</a>, len: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a>, z: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a>)</code><a class="srclink" href="../../src/corundum/lib.rs.html#164" title="goto source code">[src]</a></h4><h4 id="method.zone-1" class="method hidden"><code>pub fn <a href="#method.zone-1" class="fnname">zone</a>(off: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u64.html">u64</a>) -&gt; <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a></code><a class="srclink" href="../../src/corundum/lib.rs.html#164" title="goto source code">[src]</a></h4><h4 id="method.perform-2" class="method hidden"><code>pub unsafe fn <a href="#method.perform-2" class="fnname">perform</a>(z: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a>)</code><a class="srclink" href="../../src/corundum/lib.rs.html#164" title="goto source code">[src]</a></h4><h4 id="method.discard-2" class="method hidden"><code>pub unsafe fn <a href="#method.discard-2" class="fnname">discard</a>(z: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a>)</code><a class="srclink" href="../../src/corundum/lib.rs.html#164" title="goto source code">[src]</a></h4><h4 id="method.allocated-2" class="method hidden"><code>pub fn <a href="#method.allocated-2" class="fnname">allocated</a>(off: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u64.html">u64</a>, len: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a>) -&gt; <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.bool.html">bool</a></code><a class="srclink" href="../../src/corundum/lib.rs.html#164" title="goto source code">[src]</a></h4><h4 id="method.journals_head-2" class="method hidden"><code>pub unsafe fn <a href="#method.journals_head-2" class="fnname">journals_head</a>() -&gt; &amp;'static <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u64.html">u64</a></code><a class="srclink" href="../../src/corundum/lib.rs.html#164" title="goto source code">[src]</a></h4><h4 id="method.drop_journal-2" class="method hidden"><code>pub unsafe fn <a href="#method.drop_journal-2" class="fnname">drop_journal</a>(journal: &amp;mut <a class="type" href="../../corundum/default/type.Journal.html" title="type corundum::default::Journal">Journal</a>)</code><a class="srclink" href="../../src/corundum/lib.rs.html#164" title="goto source code">[src]</a></h4><h4 id="method.journals-2" class="method hidden"><code>pub unsafe fn <a href="#method.journals-2" class="fnname">journals</a>&lt;T, F:&nbsp;<a class="trait" href="https://doc.rust-lang.org/nightly/core/ops/function/trait.Fn.html" title="trait core::ops::function::Fn">Fn</a>(&amp;mut <a class="struct" href="https://doc.rust-lang.org/nightly/std/collections/hash/map/struct.HashMap.html" title="struct std::collections::hash::map::HashMap">HashMap</a>&lt;<a class="struct" href="https://doc.rust-lang.org/nightly/std/thread/struct.ThreadId.html" title="struct std::thread::ThreadId">ThreadId</a>, <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.tuple.html">(</a><a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u64.html">u64</a>, <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.i32.html">i32</a><a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.tuple.html">)</a>&gt;) -&gt; T&gt;(<br>&nbsp;&nbsp;&nbsp;&nbsp;f: F<br>) -&gt; T</code><a class="srclink" href="../../src/corundum/lib.rs.html#164" title="goto source code">[src]</a></h4><h4 id="method.recover-2" class="method hidden"><code>pub unsafe fn <a href="#method.recover-2" class="fnname">recover</a>()</code><a class="srclink" href="../../src/corundum/lib.rs.html#164" title="goto source code">[src]</a></h4><h4 id="method.open-2" class="method hidden"><code>pub fn <a href="#method.open-2" class="fnname">open</a>&lt;'a, U:&nbsp;'a + <a class="trait" href="../../corundum/trait.PSafe.html" title="trait corundum::PSafe">PSafe</a> + <a class="trait" href="../../corundum/cell/trait.RootObj.html" title="trait corundum::cell::RootObj">RootObj</a>&lt;Self&gt;&gt;(<br>&nbsp;&nbsp;&nbsp;&nbsp;path: &amp;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.str.html">str</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;flags: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u32.html">u32</a><br>) -&gt; <a class="type" href="../../corundum/result/type.Result.html" title="type corundum::result::Result">Result</a>&lt;<a class="struct" href="../../corundum/cell/struct.RootCell.html" title="struct corundum::cell::RootCell">RootCell</a>&lt;'a, U, Self&gt;&gt;</code><a class="srclink" href="../../src/corundum/lib.rs.html#164" title="goto source code">[src]</a></h4><h4 id="method.is_open-2" class="method hidden"><code>pub fn <a href="#method.is_open-2" class="fnname">is_open</a>() -&gt; <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.bool.html">bool</a></code><a class="srclink" href="../../src/corundum/lib.rs.html#164" title="goto source code">[src]</a></h4><h4 id="method.open_no_root-2" class="method hidden"><code>pub fn <a href="#method.open_no_root-2" class="fnname">open_no_root</a>(path: &amp;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.str.html">str</a>, flags: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u32.html">u32</a>) -&gt; <a class="type" href="../../corundum/result/type.Result.html" title="type corundum::result::Result">Result</a>&lt;Self&gt;</code><a class="srclink" href="../../src/corundum/lib.rs.html#164" title="goto source code">[src]</a></h4><h4 id="method.close-2" class="method hidden"><code>pub unsafe fn <a href="#method.close-2" class="fnname">close</a>() -&gt; <a class="type" href="../../corundum/result/type.Result.html" title="type corundum::result::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.unit.html">()</a>&gt;</code><a class="srclink" href="../../src/corundum/lib.rs.html#164" title="goto source code">[src]</a></h4><h4 id="method.print_info-1" class="method hidden"><code>pub fn <a href="#method.print_info-1" class="fnname">print_info</a>()</code><a class="srclink" href="../../src/corundum/lib.rs.html#164" title="goto source code">[src]</a></h4></div></div><span class="loading-content">Loading content...</span><script type="text/javascript" src="../../implementors/corundum/alloc/trait.MemPool.js" async></script></section><section id="search" class="content hidden"></section><section class="footer"></section><script>window.rootPath = "../../";window.currentCrate = "corundum";</script><script src="../../main.js"></script><script defer src="../../search-index.js"></script></body></html>